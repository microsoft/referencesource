//-------------------------------------------------------------------------------------------------
//
//  Copyright (c) Microsoft Corporation.  All rights reserved.
//
//-------------------------------------------------------------------------------------------------

#include "StdAfx.h"

// from xmlparser.h
enum
{    
    XML_E_PARSEERRORBASE    = 0xc00ce500L,
    XML_E_ENDOFINPUT    = XML_E_PARSEERRORBASE,
    XML_E_MISSINGEQUALS    = XML_E_ENDOFINPUT + 1,
    XML_E_MISSINGQUOTE    = XML_E_MISSINGEQUALS + 1,
    XML_E_COMMENTSYNTAX    = XML_E_MISSINGQUOTE + 1,
    XML_E_BADSTARTNAMECHAR    = XML_E_COMMENTSYNTAX + 1,
    XML_E_BADNAMECHAR    = XML_E_BADSTARTNAMECHAR + 1,
    XML_E_BADCHARINSTRING    = XML_E_BADNAMECHAR + 1,
    XML_E_XMLDECLSYNTAX    = XML_E_BADCHARINSTRING + 1,
    XML_E_BADCHARDATA    = XML_E_XMLDECLSYNTAX + 1,
    XML_E_MISSINGWHITESPACE    = XML_E_BADCHARDATA + 1,
    XML_E_EXPECTINGTAGEND    = XML_E_MISSINGWHITESPACE + 1,
    XML_E_BADCHARINDTD    = XML_E_EXPECTINGTAGEND + 1,
    XML_E_BADCHARINDECL    = XML_E_BADCHARINDTD + 1,
    XML_E_MISSINGSEMICOLON    = XML_E_BADCHARINDECL + 1,
    XML_E_BADCHARINENTREF    = XML_E_MISSINGSEMICOLON + 1,
    XML_E_UNBALANCEDPAREN    = XML_E_BADCHARINENTREF + 1,
    XML_E_EXPECTINGOPENBRACKET    = XML_E_UNBALANCEDPAREN + 1,
    XML_E_BADENDCONDSECT    = XML_E_EXPECTINGOPENBRACKET + 1,
    XML_E_INTERNALERROR    = XML_E_BADENDCONDSECT + 1,
    XML_E_UNEXPECTED_WHITESPACE    = XML_E_INTERNALERROR + 1,
    XML_E_INCOMPLETE_ENCODING    = XML_E_UNEXPECTED_WHITESPACE + 1,
    XML_E_BADCHARINMIXEDMODEL    = XML_E_INCOMPLETE_ENCODING + 1,
    XML_E_MISSING_STAR    = XML_E_BADCHARINMIXEDMODEL + 1,
    XML_E_BADCHARINMODEL    = XML_E_MISSING_STAR + 1,
    XML_E_MISSING_PAREN    = XML_E_BADCHARINMODEL + 1,
    XML_E_BADCHARINENUMERATION    = XML_E_MISSING_PAREN + 1,
    XML_E_PIDECLSYNTAX    = XML_E_BADCHARINENUMERATION + 1,
    XML_E_EXPECTINGCLOSEQUOTE    = XML_E_PIDECLSYNTAX + 1,
    XML_E_MULTIPLE_COLONS    = XML_E_EXPECTINGCLOSEQUOTE + 1,
    XML_E_INVALID_DECIMAL    = XML_E_MULTIPLE_COLONS + 1,
    XML_E_INVALID_HEXIDECIMAL    = XML_E_INVALID_DECIMAL + 1,
    XML_E_INVALID_UNICODE    = XML_E_INVALID_HEXIDECIMAL + 1,
    XML_E_WHITESPACEORQUESTIONMARK    = XML_E_INVALID_UNICODE + 1,
    XML_E_ENDOFPE    = XML_E_WHITESPACEORQUESTIONMARK + 1,
    XML_E_TOKEN_ERROR    = XML_E_PARSEERRORBASE + 0x50,
    XML_E_SUSPENDED    = XML_E_TOKEN_ERROR,
    XML_E_STOPPED    = XML_E_SUSPENDED + 1,
    XML_E_UNEXPECTEDENDTAG    = XML_E_STOPPED + 1,
    XML_E_UNCLOSEDTAG    = XML_E_UNEXPECTEDENDTAG + 1,
    XML_E_DUPLICATEATTRIBUTE    = XML_E_UNCLOSEDTAG + 1,
    XML_E_MULTIPLEROOTS    = XML_E_DUPLICATEATTRIBUTE + 1,
    XML_E_INVALIDATROOTLEVEL    = XML_E_MULTIPLEROOTS + 1,
    XML_E_BADXMLDECL    = XML_E_INVALIDATROOTLEVEL + 1,
    XML_E_MISSINGROOT    = XML_E_BADXMLDECL + 1,
    XML_E_UNEXPECTEDEOF    = XML_E_MISSINGROOT + 1,
    XML_E_BADPEREFINSUBSET    = XML_E_UNEXPECTEDEOF + 1,
    XML_E_PE_NESTING    = XML_E_BADPEREFINSUBSET + 1,
    XML_E_INVALID_CDATACLOSINGTAG    = XML_E_PE_NESTING + 1,
    XML_E_UNCLOSEDPI    = XML_E_INVALID_CDATACLOSINGTAG + 1,
    XML_E_UNCLOSEDSTARTTAG    = XML_E_UNCLOSEDPI + 1,
    XML_E_UNCLOSEDENDTAG    = XML_E_UNCLOSEDSTARTTAG + 1,
    XML_E_UNCLOSEDSTRING    = XML_E_UNCLOSEDENDTAG + 1,
    XML_E_UNCLOSEDCOMMENT    = XML_E_UNCLOSEDSTRING + 1,
    XML_E_UNCLOSEDDECL    = XML_E_UNCLOSEDCOMMENT + 1,
    XML_E_UNCLOSEDMARKUPDECL    = XML_E_UNCLOSEDDECL + 1,
    XML_E_UNCLOSEDCDATA    = XML_E_UNCLOSEDMARKUPDECL + 1,
    XML_E_BADDECLNAME    = XML_E_UNCLOSEDCDATA + 1,
    XML_E_BADEXTERNALID    = XML_E_BADDECLNAME + 1,
    XML_E_BADELEMENTINDTD    = XML_E_BADEXTERNALID + 1,
    XML_E_RESERVEDNAMESPACE    = XML_E_BADELEMENTINDTD + 1,
    XML_E_EXPECTING_VERSION    = XML_E_RESERVEDNAMESPACE + 1,
    XML_E_EXPECTING_ENCODING    = XML_E_EXPECTING_VERSION + 1,
    XML_E_EXPECTING_NAME    = XML_E_EXPECTING_ENCODING + 1,
    XML_E_UNEXPECTED_ATTRIBUTE    = XML_E_EXPECTING_NAME + 1,
    XML_E_ENDTAGMISMATCH    = XML_E_UNEXPECTED_ATTRIBUTE + 1,
    XML_E_INVALIDENCODING    = XML_E_ENDTAGMISMATCH + 1,
    XML_E_INVALIDSWITCH    = XML_E_INVALIDENCODING + 1,
    XML_E_EXPECTING_NDATA    = XML_E_INVALIDSWITCH + 1,
    XML_E_INVALID_MODEL    = XML_E_EXPECTING_NDATA + 1,
    XML_E_INVALID_TYPE    = XML_E_INVALID_MODEL + 1,
    XML_E_INVALIDXMLSPACE    = XML_E_INVALID_TYPE + 1,
    XML_E_MULTI_ATTR_VALUE    = XML_E_INVALIDXMLSPACE + 1,
    XML_E_INVALID_PRESENCE    = XML_E_MULTI_ATTR_VALUE + 1,
    XML_E_BADXMLCASE    = XML_E_INVALID_PRESENCE + 1,
    XML_E_CONDSECTINSUBSET    = XML_E_BADXMLCASE + 1,
    XML_E_CDATAINVALID    = XML_E_CONDSECTINSUBSET + 1,
    XML_E_INVALID_STANDALONE    = XML_E_CDATAINVALID + 1,
    XML_E_UNEXPECTED_STANDALONE    = XML_E_INVALID_STANDALONE + 1,
    XML_E_DOCTYPE_IN_DTD    = XML_E_UNEXPECTED_STANDALONE + 1,
    XML_E_MISSING_ENTITY    = XML_E_DOCTYPE_IN_DTD + 1,
    XML_E_ENTITYREF_INNAME    = XML_E_MISSING_ENTITY + 1,
    XML_E_DOCTYPE_OUTSIDE_PROLOG    = XML_E_ENTITYREF_INNAME + 1,
    XML_E_INVALID_VERSION    = XML_E_DOCTYPE_OUTSIDE_PROLOG + 1,
    XML_E_DTDELEMENT_OUTSIDE_DTD    = XML_E_INVALID_VERSION + 1,
    XML_E_DUPLICATEDOCTYPE    = XML_E_DTDELEMENT_OUTSIDE_DTD + 1,
    XML_E_RESOURCE    = XML_E_DUPLICATEDOCTYPE + 1,
    XML_E_MISSINGNAME    = XML_E_RESOURCE + 1,
    XML_E_LASTERROR    = XML_E_MISSINGNAME + 1
} XML_ERROR_CODE;

//
// These character property tables are generated by gentable.cxx.
// Do not modify them directly.
//

BYTE g_anCharProps[28 * 256] = {
   0,0,0,0,0,0,0,0,0,49,49,0,0,49,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,49,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,184,184,184,184,184,184,184,184,184,184,60,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,252,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,254,254,48,48,48,48,254,254,254,254,254,254,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,184,254,254,254,48,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,48,48,254,48,254,48,254,48,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,
   48,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,184,184,184,184,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,48,48,254,254,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,48,48,254,254,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,184,184,184,48,184,48,184,184,48,184,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,184,254,254,254,254,254,254,254,254,254,254,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,184,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,48,254,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,254,254,184,184,48,184,184,184,184,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,184,184,184,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,184,254,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,48,48,184,184,184,184,48,48,48,254,254,254,254,254,254,254,254,254,254,184,184,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,184,48,254,254,254,254,254,254,254,254,48,48,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,254,48,48,48,254,254,254,254,48,48,184,48,184,184,184,184,184,184,184,48,48,184,184,48,48,184,184,184,48,48,48,48,48,48,48,48,48,184,48,48,48,48,254,254,48,254,254,254,184,184,48,48,184,184,184,184,184,184,184,184,184,184,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,184,48,48,254,254,254,254,254,254,48,48,48,48,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,254,254,48,254,254,48,254,254,48,48,184,48,184,184,184,184,184,48,48,48,48,184,184,48,48,184,184,184,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,48,254,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,184,184,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,184,184,184,48,254,254,254,254,254,254,254,48,254,48,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,254,254,48,254,254,254,254,254,48,48,184,254,184,184,184,184,184,184,184,184,48,184,184,184,48,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,184,184,184,48,254,254,254,254,254,254,254,254,48,48,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,254,254,48,48,254,254,254,254,48,48,184,254,184,184,184,184,184,184,48,48,48,184,184,48,48,184,184,184,48,48,48,48,48,48,48,48,184,184,48,48,48,48,254,254,48,254,254,254,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,254,254,254,254,254,254,48,48,48,254,254,254,48,254,254,254,254,48,48,48,254,254,48,254,48,254,254,48,48,48,254,254,48,48,48,254,254,254,48,48,48,254,254,254,254,254,254,254,254,48,254,254,254,48,48,48,48,184,184,184,184,184,48,48,48,184,184,184,48,184,184,184,184,48,48,48,48,48,48,48,48,48,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,184,184,184,48,254,254,254,254,254,254,254,254,48,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,48,48,48,48,184,184,184,184,184,184,184,48,184,184,184,48,184,184,184,184,48,48,48,48,48,48,48,184,184,48,48,48,48,48,48,48,48,48,254,254,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,254,254,254,254,254,254,254,254,48,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,48,48,48,48,184,184,184,184,184,184,184,48,184,184,184,48,184,184,184,184,48,48,48,48,48,48,48,184,184,48,48,48,48,48,48,48,254,48,254,254,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,184,184,48,254,254,254,254,254,254,254,254,48,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,184,184,184,184,184,184,48,48,184,184,184,48,184,184,184,184,48,48,48,48,48,48,48,48,48,184,48,48,48,48,48,48,48,48,254,254,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,184,254,254,184,184,184,184,184,184,184,48,48,48,48,48,254,254,254,254,254,254,184,184,184,184,184,184,184,184,184,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,48,254,48,48,254,254,48,254,48,48,254,48,48,48,48,48,48,254,254,254,254,48,254,254,254,254,254,254,254,48,254,254,254,48,254,48,254,48,48,254,254,48,254,254,48,254,184,254,254,184,184,184,184,184,184,48,184,184,254,48,48,254,254,254,254,254,48,184,48,184,184,184,184,184,184,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,184,48,184,48,184,48,48,48,48,184,184,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,184,184,184,184,184,184,48,48,48,48,184,184,184,184,184,184,48,184,48,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,184,48,48,48,184,184,184,184,184,184,184,48,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,
   254,48,254,254,48,254,254,254,48,254,48,254,254,48,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,48,254,48,254,48,48,48,48,48,48,48,48,48,48,48,254,48,254,48,254,48,48,48,254,254,48,48,48,254,48,48,48,48,48,254,254,254,48,254,48,254,48,254,48,254,48,48,48,254,254,48,48,48,254,254,48,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,48,48,48,48,48,48,48,48,48,254,48,48,254,48,48,254,254,48,48,48,48,48,48,48,254,254,48,254,48,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,48,48,48,48,254,48,48,48,48,48,48,48,48,254,48,48,48,48,48,48,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,48,254,48,254,48,254,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,254,254,254,254,254,254,254,48,254,48,48,48,254,254,254,48,254,254,254,254,254,254,254,48,48,48,254,254,254,254,48,48,254,254,254,254,254,254,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,254,254,254,48,254,254,254,254,254,254,254,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,184,184,184,184,184,184,184,184,184,184,184,184,184,48,48,48,48,184,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,48,48,48,254,254,48,48,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   48,48,48,48,48,184,48,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,184,184,184,184,184,184,48,184,184,184,184,184,48,48,48,48,48,48,48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,184,184,48,48,184,184,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,184,184,184,48,
   48,48,48,48,48,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,254,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,
   32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,
   48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,0,0,
};

BYTE * g_apCharTables[256] = {
    &g_anCharProps[0], &g_anCharProps[256], &g_anCharProps[512], &g_anCharProps[768], &g_anCharProps[1024], &g_anCharProps[1280], &g_anCharProps[1536], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[2048], &g_anCharProps[2304], &g_anCharProps[2560], &g_anCharProps[2816], &g_anCharProps[3072], &g_anCharProps[3328], &g_anCharProps[3584],
    &g_anCharProps[3840], &g_anCharProps[4096], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[4352], &g_anCharProps[4608],
    &g_anCharProps[4864], &g_anCharProps[5120], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[5376], &g_anCharProps[5632], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[6144],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888],
    &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[5888], &g_anCharProps[6400],
    &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656], &g_anCharProps[6656],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792],
    &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[1792], &g_anCharProps[6912],
};

//
// LanguageID ::= (IANACode || UserCode || ISO639) ('-' SubCode)*
// ISO639 ::= ([a-z] | [A-Z])([a-z] | [A-Z])
// IANACode ::= ('i' | 'I') '-' ([a-z] | [A-Z])+
// UserCode ::= ('x' | 'X') '-' ([a-z] | [A-Z])+
// SubCode :;= ([a-z] | [A-Z])+
//
bool
isValidLanguageID(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen)
{
    WCHAR ch;
    bool fSeenLetter = false;

    if (ulLen < 2)
        goto Err;

    ch = *pwcText;
    if (XmlCharacter::isLetter(ch))
    {
        if (XmlCharacter::isLetter(*(++pwcText))) // ISO639 Code: a two-letter language code as defined by ISO 639
        {
            if (2 == ulLen)
                return true;
            ulLen--;
            pwcText++;
        }
        else if ('I' != ch && 'i' != ch && //IANA Code
                 'X' != ch && 'x' != ch)    // User Code
        {
            goto Err;
        }

        if ('-' != *pwcText)
            goto Err;
        ulLen -= 2;

        while (ulLen-- > 0)
        {
            ch = *(++pwcText);
            if (XmlCharacter::isLetter(ch))
            {
                fSeenLetter = true;
            }
            else if ('-' == ch && fSeenLetter)
            {
                fSeenLetter = false;
            }
            else
            {
                goto Err;
            }
        }

        if (fSeenLetter)
            return true;
    }

Err:
    return false;
}

bool
isValidPublicID(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen)
{
    // length of 0 is OK
    while (ulLen-- > 0)
    {
        if (!XmlCharacter::isPubidChar(*pwcText++))
        {
            return false;
        }
    }
    return true;
}

bool
isValidSystemID(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen)
{
    while (ulLen-- > 0)
    {
        if (*pwcText++ == '#')
        {
            return false;
        }
    }
    return true;
}

static bool
isValidEncStartChar(WCHAR ch)
{
    return (ch >= 0x41 && ch <= 0x5A) || (ch >= 0x61 && ch <= 0x7A);
}

static bool
isValidEncChar(WCHAR ch)
{
    return (ch >= 0x41 && ch <= 0x5A) || (ch >= 0x61 && ch <= 0x7A)
           || (ch >= 0x30 && ch <= 0x39) || ch == 0x2D || ch == 0x2E || ch == 0x5F;
}

bool
isValidEncName(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen)
{
    if (!ulLen-- || !isValidEncStartChar(*pwcText++))
    {
        return false;
    }
    while (ulLen--)
    {
        if (!isValidEncChar(*pwcText++))
        {
            return false;
        }
    }
    return true;
}

bool
isXmlWhitespace(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen)
{
    while (ulLen && XmlCharacter::isWhitespace(*pwcText))
    {
        ulLen--;
        pwcText++;
    }

    return (ulLen == 0);
}

WCHAR BuiltinEntity(_In_count_(ulLen) const WCHAR* pwcText, size_t ulLen)
{
    size_t ulSize =  VBMath::Multiply(ulLen, sizeof(WCHAR)); // Length in chars 
    switch (ulLen)
    {
    case 4:
        if (::memcmp(L"quot", pwcText, ulSize) == 0)
        {
            return 34;
        }
        else if (::memcmp(L"apos", pwcText, ulSize) == 0)
        {
            return 39;
        }
        break;
    case 3:
        if (::memcmp(L"amp", pwcText, ulSize) == 0)
        {
            return 38;
        }
        break;
    case 2:
        if (::memcmp(L"lt", pwcText, ulSize) == 0)
        {
            return 60;
        }
        else if (::memcmp(L"gt", pwcText, ulSize) == 0)
        {
            return 62;
        }
        break;
    }
    return 0;
}

static HRESULT
HexToUnicode(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen, _Out_ ULONG * pulCode)
{
    ULONG ulCode = 0;
    WCHAR wch;

    while (ulLen--)
    {
        wch = *pwcText++;
        if (wch >= L'0' && wch <= L'9')
        {
            ulCode = (ulCode * 16) + wch - L'0';
        }
        else if (wch >= L'a' && wch <= L'f')
        {
            ulCode = (ulCode * 16) + 10 + wch - L'a';
        }
        else if (wch >= L'A' && wch <= L'F')
        {
            ulCode = (ulCode * 16) + 10 + wch - L'A';
        }
        else
        {
            return XML_E_INVALID_HEXIDECIMAL;
        }
        if (ulCode > 0x10FFFF) // overflow
        {
            return XML_E_INVALID_UNICODE;
        }
    }
    *pulCode = ulCode;
    return S_OK;
}

static HRESULT
DecToUnicode(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen, _Out_ ULONG * pulCode)
{
    ULONG ulCode = 0;
    WCHAR wch;

    while (ulLen--)
    {
        wch = *pwcText++;
        if (wch >= L'0' && wch <= L'9')
        {
            ulCode = (ulCode * 10) + wch - L'0';
        }
        else
        {
            return XML_E_INVALID_DECIMAL;
        }
        if (ulCode > 0x10FFFF) // overflow
        {
            return XML_E_INVALID_UNICODE;
        }
    }
    *pulCode = ulCode;
    return S_OK;
}

static HRESULT
ValidateXmlChar(ULONG ulCode)
{
    if ((ulCode < 0xD800 && (ulCode > 0x1F || XmlCharacter::isWhitespace((WCHAR)ulCode)))
        || (ulCode < 0xFFFE && ulCode > 0xDFFF)
        || (ulCode < 0x110000 && ulCode > 0xFFFF))
    {
        return S_OK;
    }
    return XML_E_INVALID_UNICODE;
}


HRESULT
UnicodeToUTF16(ULONG ulCode, _Out_z_cap_(cchOut)  WCHAR * pwcUtf16, unsigned cchOut)
{
    if (cchOut < 3)
    {
        return E_INVALIDARG;
    }

    if (ulCode > 0xFFFF)
    {
        pwcUtf16[0] = 0xD7C0 + (WCHAR)(ulCode >> 10);
        pwcUtf16[1] = 0xDC00 | (WCHAR)(ulCode & 0x3FF);
        pwcUtf16[2] = 0;
    }
    else
    {
        pwcUtf16[0] = (WCHAR)ulCode;
        pwcUtf16[1] = 0;
    }
    return S_OK;
}


HRESULT
DecToUTF16(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen, _Out_z_cap_(cchOut) WCHAR * pwcUtf16, unsigned cchOut)
{
    HRESULT hr;
    ULONG   ulCode;

    hr = DecToUnicode(pwcText, ulLen, &ulCode);
    if (FAILED(hr)) goto CleanUp;
    hr = UnicodeToUTF16(ulCode, pwcUtf16, cchOut);
    if (FAILED(hr)) goto CleanUp;
    hr = ValidateXmlChar(ulCode);
CleanUp:
    return hr;
}


HRESULT
HexToUTF16(_In_count_(ulLen) const WCHAR * pwcText, size_t ulLen, _Out_z_cap_(cchOut) WCHAR * pwcUtf16, unsigned cchOut)
{
    HRESULT hr;
    ULONG   ulCode;

    hr = HexToUnicode(pwcText, ulLen, &ulCode);
    if (FAILED(hr)) goto CleanUp;
    hr = UnicodeToUTF16(ulCode, pwcUtf16, cchOut);
    if (FAILED(hr)) goto CleanUp;
    hr = ValidateXmlChar(ulCode);
CleanUp:
    return hr;
}


#ifdef UNIX
    const unsigned char s_ByteOrderMarkTrident[sizeof(WCHAR)] = { 0xFF, 0xFE, 0xFF, 0xFE };
    const unsigned char s_ByteOrderMark[sizeof(WCHAR)] = { 0xFE, 0xFF, 0xFE, 0xFF };
    const unsigned char s_ByteOrderMarkUCS2[2] = { 0xFF, 0xFE };
#else
    const unsigned char s_ByteOrderMark[2] = { 0xFF, 0xFE };
#endif
